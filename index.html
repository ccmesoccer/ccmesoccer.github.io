<!doctype html>

<!--
Author: Yufei Wu
Last Edited on 18/06/2021
-->

<html>
	
<head>
	
<script src="./js/loadXML.js"></script>
<script src="./js/print2DArray.js"></script>
<script src="./js/sort.js"></script>

</head>
	

<body>
<script>

xmlDoc = loadXML("./data/playerlist.xml");  // 读入xml文件

/*验证xml读取是否成功
for (i=1;i<xmlDoc.getElementsByTagName("player").length;i++)
{
document.write(xmlDoc.getElementsByTagName("player")[i].getElementsByTagName("num")[0].childNodes[0].nodeValue);
document.write("<br />");
document.write(xmlDoc.getElementsByTagName("player")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue);
document.write("<br />");
document.write(xmlDoc.getElementsByTagName("player")[i].getElementsByTagName("app")[0].childNodes[0].nodeValue);
}
*/

x=xmlDoc.getElementsByTagName("player");

var playersColumn = [];
for (i=0;i<x[0].childNodes.length;i++){
	if (x[0].childNodes[i].nodeType==1){
		playersColumn.push(x[0].childNodes[i].childNodes[0].nodeValue);
		}
}

var playersList = [];
for (j=1;j<x.length;j++){
	playersList[j-1]=[];
	for (i=0;i<x[j].childNodes.length;i++){
		if (x[j].childNodes[i].nodeType==1){
			playersList[j-1].push(x[j].childNodes[i].childNodes[0].nodeValue);
		}
	}
}

length = playersColumn.length;

function sortPrintPlayersList(code, sign) {
	playersList.sort(function(x,y){
		if(x[code] == '-') return 1000;
		else if(y[code] == '-') return -1000;  // 这两行处理是'-'的数据，不论升序还是降序都排在最后
		else return sign * (x[code] - y[code]);
	})
	
	
	var table='<table border="1" align="center"><tr>';
	// 表头
	for (i=0;i<length;i++){
		table += '<th align="center">' + playersColumn[i] + '</th>'; 
	}
	table += '</tr>';

	// 表格内容
	for (j=0;j<playersList.length;j++){
		table += '<tr>';
		for (i=0;i<length;i++){
			table += '<td align="center">' + playersList[j][i] +'</td>';
		}
		table += '</tr>';
	}
	table += '</table>';
	return table;
}
</script>
	
<div id="demo">
	<script>
		//预排序
		document.getElementById('demo').innerHTML=sortPrintPlayersList(0, 1);  // 第一个指标：对哪一列进行排序；第二个指标：升序(1)、降序(-1)
	</script>
</div>
<button onclick="document.getElementById('demo').innerHTML=sortPrintPlayersList(5, 0);">按进球数排序</button>
<button onclick="document.write(sortPrintPlayersList(4, 0));">按出场次数排序</button>





<br /><br />

</body>


</html>


